import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Load the CSV file
df = pd.read_csv('Unemployment in India.csv')

# --- Data Cleaning and Preparation ---

# Strip whitespace from column names
df.columns = df.columns.str.strip()

# Convert 'Date' to datetime, assuming day-first format (31-05-2019)
df['Date'] = pd.to_datetime(df['Date'], dayfirst=True)

# Drop rows with any missing values
df.dropna(inplace=True)

# Rename columns for easier use
df.rename(columns={
    'Estimated Unemployment Rate (%)': 'Unemployment Rate',
    'Estimated Employed': 'Employed',
    'Estimated Labour Participation Rate (%)': 'Labour Participation Rate'
}, inplace=True)

# --- Visualization ---

sns.set_style("whitegrid")

# 1. Bar plot of Average Unemployment Rate by Region (State)
region_avg_unemp = df.groupby('Region')['Unemployment Rate'].mean().sort_values(ascending=False)

plt.figure(figsize=(14, 8))
sns.barplot(x=region_avg_unemp.index, y=region_avg_unemp.values, palette='viridis')
plt.title('Average Unemployment Rate (%) by Region (State)', fontsize=16)
plt.xlabel('Region', fontsize=12)
plt.ylabel('Average Unemployment Rate (%)', fontsize=12)
plt.xticks(rotation=90)
plt.tight_layout()
plt.savefig('Average_Unemployment_Rate_by_Region.png')
plt.close()

# 2. Time series plot of All-India Average Unemployment Rate
monthly_avg_unemp = df.groupby('Date')['Unemployment Rate'].mean()

plt.figure(figsize=(12, 6))
plt.plot(monthly_avg_unemp.index, monthly_avg_unemp.values, marker='o', linestyle='-', color='skyblue')
plt.title('All-India Average Unemployment Rate Over Time', fontsize=16)
plt.xlabel('Date', fontsize=12)
plt.ylabel('Average Unemployment Rate (%)', fontsize=12)
plt.xticks(rotation=45)
plt.grid(True)
plt.tight_layout()
plt.savefig('All_India_Monthly_Unemployment_Rate.png')
plt.close()

# 3. Box plot of Unemployment Rate distribution by Area (Rural vs. Urban)
plt.figure(figsize=(8, 6))
sns.boxplot(x='Area', y='Unemployment Rate', data=df, palette='Set2')
plt.title('Unemployment Rate Distribution by Area', fontsize=16)
plt.xlabel('Area', fontsize=12)
plt.ylabel('Unemployment Rate (%)', fontsize=12)
plt.tight_layout()
plt.savefig('Unemployment_Rate_by_Area_Boxplot.png')
plt.close()
